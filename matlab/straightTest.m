O = [2, 0, 0, 8, 6, 6, 0, 6, 6, 0, 6, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 2, 3, 2, 5, 0, 0, 0, 4, 6, 6, 6, 6, 2, 5, 2, 3, 2, 5, 5, 5, 2, 5, 5, 2, 5, 5, 2, 5, 5, 0, 6, 7, 6, 6, 0, 7, 6, 6, 6, 6, 7, 6, 7, 6, 6, 6, 6, 7, 6, 6, 7, 2, 5, 5, 2, 2, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 6, 6, 7, 6, 6, 6, 7, 6, 6, 6, 7, 7, 6, 6, 6, 0, 6, 6, 6, 6, 6, 2, 5, 2, 2, 2, 3, 2, 5, 5, 2, 5, 5, 2, 2, 0, 0, 0, 0, 3, 6, 6, 6, 6, 6, 6, 7, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 3, 0, 7, 2, 5, 2, 2, 5, 5, 2, 5, 3, 5, 5, 5, 5, 2, 5, 5, 5, 2, 2, 5, 2, 0, 0, 3, 0, 0, 1, 8, 6, 0, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 6, 0, 6, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 6, 6, 2, 8, 6, 6, 7, 7, 6, 6, 6, 7, 6, 6, 6, 7, 6, 6, 6, 0, 0, 0, 1, 0, 0, 0, 3, 0, 0, 1, 0, 0, 6, 6, 6, 6, 6, 7, 7, 6, 6, 2, 5, 2, 5, 0, 3, 0, 0, 8, 6, 6, 1, 6, 6, 6, 6, 7, 0, 1, 0, 0, 0, 0, 6, 7, 2, 0, 3, 0, 0, 0, 7, 6, 6, 6, 2, 3, 5, 5, 5, 5, 5, 2, 5, 5, 5, 5, 3, 6, 6, 6, 6, 6, 7, 6, 6, 2, 2, 5, 3, 2, 5, 2, 5, 0, 0, 1, 0, 0, 1, 8, 6, 6, 7, 6, 0, 7, 0, 6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 7, 0, 7, 6, 6, 6, 1, 6, 2, 5, 2, 2, 2, 2, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 0, 4, 0, 0, 1, 0, 0, 1, 0, 0, 1, 3, 0, 0, 6, 7, 6, 6, 0, 0, 3, 0, 0, 3, 4, 3, 0, 0, 0, 0, 0, 3, 0, 0, 4, 3, 0, 0, 0, 3, 1, 8, 6, 6, 6, 6, 6, 2, 2, 2, 0, 5, 0, 6, 6, 6, 7, 7, 6, 6, 0, 1, 1, 0, 3, 0, 6, 6, 6, 6, 6, 6, 7, 6, 7, 6, 7, 6, 6, 7, 7, 6, 6, 7, 7, 6, 1, 4, 6, 0, 5, 5, 5, 6, 2, 5, 8, 0, 2, 6, 6, 6, 7, 6, 6, 6, 7, 0, 1, 3, 0, 3, 0, 0, 3, 3, 0, 6, 6, 0, 8, 2, 2];
% Xavi note
O = [6, 0, 0, 8, 2, 2, 0, 2, 2, 0, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 6, 1, 6, 7, 0, 0, 0, 4, 2, 2, 2, 2, 6, 7, 6, 1, 6, 7, 7, 7, 6, 7, 7, 6, 7, 7, 6, 7, 7, 0, 2, 5, 2, 2, 0, 5, 2, 2, 2, 2, 5, 2, 5, 2, 2, 2, 2, 5, 2, 2, 5, 6, 7, 7, 6, 6, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 5, 2, 2, 2, 5, 2, 2, 2, 5, 5, 2, 2, 2, 0, 2, 2, 2, 2, 2, 6, 7, 6, 6, 6, 1, 6, 7, 7, 6, 7, 7, 6, 6, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 5, 3, 0, 0, 0, 3, 0, 3, 3, 3, 0, 1, 0, 5, 6, 7, 6, 6, 7, 7, 6, 7, 1, 7, 7, 7, 7, 6, 7, 7, 7, 6, 6, 7, 6, 0, 0, 1, 0, 0, 3, 8, 2, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 0, 2, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 6, 8, 2, 2, 5, 5, 2, 2, 2, 5, 2, 2, 2, 5, 2, 2, 2, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, 3, 0, 0, 2, 2, 2, 2, 2, 5, 5, 2, 2, 6, 7, 6, 7, 0, 1, 0, 0, 8, 2, 2, 3, 2, 2, 2, 2, 5, 0, 3, 0, 0, 0, 0, 2, 5, 6, 0, 1, 0, 0, 0, 5, 2, 2, 2, 6, 1, 7, 7, 7, 7, 7, 6, 7, 7, 7, 7, 1, 2, 2, 2, 2, 2, 5, 2, 2, 6, 6, 7, 1, 6, 7, 6, 7, 0, 0, 3, 0, 0, 3, 8, 2, 2, 5, 2, 0, 5, 0, 2, 2, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 5, 0, 5, 2, 2, 2, 3, 2, 6, 7, 6, 6, 6, 6, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 4, 0, 0, 3, 0, 0, 3, 0, 0, 3, 1, 0, 0, 2, 5, 2, 2, 0, 0, 1, 0, 0, 1, 4, 1, 0, 0, 0, 0, 0, 1, 0, 0, 4, 1, 0, 0, 0, 1, 3, 8, 2, 2, 2, 2, 2, 6, 6, 6, 0, 7, 0, 2, 2, 2, 5, 5, 2, 2, 0, 3, 3, 0, 1, 0, 2, 2, 2, 2, 2, 2, 5, 2, 5, 2, 5, 2, 2, 5, 5, 2, 2, 5, 5, 2, 3, 4, 2, 0, 7, 7, 7, 2, 6, 7, 8, 0, 6, 2, 2, 2, 5, 2, 2, 2, 5, 0, 3, 1, 0, 1, 0, 0, 1, 1, 0, 2, 2, 0, 8, 6, 6];
realA = [
    [0.85 0.15 0.00]
    [0.04 0.91 0.05]
    [0.08 0.04 0.88]
    ];

realB = [
    [0.61 0.14 0.00 0.15 0.04 0.00 0.01 0.00 0.05]
    [0.04 0.00 0.77 0.01 0.00 0.18 0.00 0.00 0.00]
    [0.03 0.06 0.01 0.00 0.00 0.00 0.43 0.45 0.02]
    ];

O = O + 1; % Matlab indices


inputA = realA;
inputB = realB;
inputO = O;

%%
disp('---------------- Matlab: Ballpark A, flat B ----------------')
[trainedA,trainedB] = hmmtrain(inputO,inputA,inputB);
MatrixMath.matrixNormDistance(realA, trainedA)
MatrixMath.matrixNormDistance(realB, trainedB)
disp('-------------------------------------------------')

%%
disp('---------------- HMMFunction: Ballpark A, flat B ----------------')
mobs = ModelledObservation(ObservationSequence(inputO-1), BirdModel(inputA, inputB, [1/3 1/3 1/3]));
mobs.refineModel(java.lang.System.currentTimeMillis() + 1000);
refinedA = mobs.lambda.A;
refinedB = mobs.lambda.B;
MatrixMath.matrixNormDistance(realA, refinedA)
MatrixMath.matrixNormDistance(realB, refinedB)
disp('-------------------------------------------------')
%}